# 病情分析

## 题目描述

医院数据后台管理，医生填入了病情，使用AI工作流自动分析病情并得出诊断结果与医嘱建议

要求使用CA与CW进行结合

## ✍️ 任务要求

1. 构建数据实体展示病情
2. 数据表格设置多选表格，对选中的数据进行分析
3. 数据分析后填入数据库并刷新
4. 构建分析病情智能体，对选中的数据进行病情分析得到诊断结果与建议并返回

### Agent工作流设计

+ 传入用户输入的选中数据id列表
+ 调用接口进行数据查询
+ 对数据进行LLM分析
+ 提取参数并返回对应的结构体


### 工作流图例
![](./assert/image8.png)

### 业务功能图例
![](./assert/image7.png)


### 测试用例

自行先搭建数据实体

```sql

TRUNCATE TABLE `illness`;

INSERT INTO `illness` (`id`,`created_time`,`updated_time`,`created_by`,`updated_by`,`user_name`,`gender`,`age`,`ill`,`result`,`suggest`) VALUES (3142200186320384,'2025-06-03 15:50:55','2025-06-07 00:22:38',null,null,'朱小明','0',48,'男性，48 岁，乙肝肝硬化病史 10 年，未规律抗病毒治疗。近 2 周出现腹胀明显，伴食欲减退、下肢水肿。查体：慢性病容，皮肤巩膜轻度黄染，肝掌（+），蜘蛛痣（+），腹部膨隆，移动性浊音（+），肝脾触诊不满意，双下肢凹陷性水肿。实验室检查：ALT 65U/L，AST 82U/L，白蛋白 28g/L（正常 40-55g/L），总胆红素 32μmol/L，凝血酶原时间（PT）18 秒（正常 11-14 秒）；腹部超声示肝脏表面不光滑，门静脉内径 1.5cm，腹腔积液深度 8cm。',null,null);
INSERT INTO `illness` (`id`,`created_time`,`updated_time`,`created_by`,`updated_by`,`user_name`,`gender`,`age`,`ill`,`result`,`suggest`) VALUES (3142201748387328,'2025-06-03 15:54:05','2025-06-07 00:22:38',null,null,'花公子','0',52,'男性，52 岁，高血压病史 10 年，血压最高达 180/110mmHg，未规律服用降压药（偶尔服用硝苯地平缓释片）。近半年出现夜尿增多（每晚 3-4 次），伴眼睑及双下肢轻度水肿。查体：血压 165/105mmHg，贫血貌，双肾区无叩痛。实验室检查：血肌酐 180μmol/L（正常范围 53-106μmol/L），尿素氮 10.2mmol/L，尿蛋白（++），尿红细胞 5-8/HP，血红蛋白 105g/L（正常男性 130-175g/L）；肾脏超声示双肾体积缩小，皮质回声增强。',null,null);
INSERT INTO `illness` (`id`,`created_time`,`updated_time`,`created_by`,`updated_by`,`user_name`,`gender`,`age`,`ill`,`result`,`suggest`) VALUES (3142202734425600,'2025-06-03 15:56:06','2025-06-07 00:22:38',null,null,'张小美','1',30,'女性，30 岁，SLE 病史 5 年，规律服用泼尼松（10mg qd）及羟氯喹治疗。近 1 个月出现乏力、面色苍白，活动后心悸，间断出现皮肤瘀点。查体：体温 37.5℃，贫血貌，四肢可见散在瘀斑，肝脾未触及肿大。实验室检查：血红蛋白 78g/L（正常女性 110-150g/L），白细胞 3.2×10⁹/L（正常 4-10×10⁹/L），血小板 65×10⁹/L（正常 100-300×10⁹/L），网织红细胞计数 0.8%；抗双链 DNA 抗体（+），补体 C3 0.5g/L（正常 0.8-1.5g/L）。',null,null);
```

## 📝 提交方式说明

本次实操题无需上传文件，请按照以下流程提交你的成果：

1. 在 CoreAgent 系统中创建一个工作流（WorkFlow），名称建议为“病情分析- 张三作品”；
2. 在该智能体工作流中完成以下内容：

* **配置提示词（Prompt）**：包含角色、背景、任务、输出格式等要素；
* **配置智能体编排流程**：在 WorkFlow 中添加以下节点：
  + 开始
  + 参数提取器
  + 迭代
  + HTTP请求
  + LLM
  + 结束

3. 在 CodeWave 系统中创建一个页面搭建业务，名称建议为“病情分析- 张三作品”；
   